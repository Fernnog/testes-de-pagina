<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alvos de Ora√ß√£o</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&display=swap">
    <link rel="stylesheet" href="styles/base.css">
    <link rel="stylesheet" href="styles/ui-components.css">
    <link rel="stylesheet" href="styles/target-components.css">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="manifest" href="manifest.json">
</head>
<body>

<!-- Splash Screen / Tela de Carregamento -->
<div id="splashScreen" class="splash-screen">
    <img src="logo.png" alt="Logo Meu Di√°rio de Ora√ß√£o" class="splash-logo">
    <p class="splash-text">Carregando seus alvos...</p>
</div>

<!-- Na parte superior do body -->
<div class="top-bar">
    <button id="btnConnectDrive" class="btn drive-connect-btn" style="display: none;">Conectar ao Drive</button>
    <span id="driveStatusTop" class="drive-status-top" style="display: none;">Conectado ao Drive ‚úì</span>
    <span id="userStatusTop" class="user-status-top" style="display: none;"></span>
    <!-- NOVO ELEMENTO DE VERS√ÉO -->
    <span id="versionInfo" class="version-info" style="display: none;"></span>
</div>

<div class="logo-container">
    <img src="logo.png" alt="Logo Meu Di√°rio de Ora√ß√£o" class="logo">
</div>

<div class="main-title">
    <h1>Meus Alvos de Ora√ß√£o</h1>
</div>

<!-- No arquivo index.html, substitua toda a div #authSection -->

<div id="authSection" class="auth-section">
    <!-- O formul√°rio de email/senha foi totalmente removido -->
    <div id="googleAuthContainer" style="display: block;">
        <p style="margin-bottom: 15px;">Acesse ou crie sua conta para sincronizar seus alvos de ora√ß√£o com o Google Drive.</p>
        <button id="btnGoogleSignIn" class="btn auth-btn google-btn">Entrar com Google</button>
    </div>

    <div class="auth-status-container" style="display: none;">
        <!-- Este container ser√° exibido pela UI.js ap√≥s o login -->
        <p id="authStatus" class="auth-status"></p>
        <button id="btnLogout" class="btn auth-btn" style="display:none;">Sair</button>
    </div>
</div>

    <hr class="menu-separator">

    <div class="main-menu" id="mainMenu">
       <button id="backToMainButton" class="btn">P√°gina Inicial</button>
       <button id="addNewTargetButton" class="btn">Novo Alvo</button>
       <button id="viewAllTargetsButton" class="btn">Ver Todos os Alvos</button>
       <button id="viewArchivedButton" class="btn archived-resolved">Ver Arquivados</button>
       <button id="viewResolvedButton" class="btn archived-resolved">Ver Respondidos</button>
    </div>

    <hr class="menu-separator dark">

    <div class="main-menu" id="secondaryMenu">
     <button id="generateViewButton" class="btn generate-view action-btn">Gerar Visualiza√ß√£o Atual</button>
     <button id="generateCategoryViewButton" class="btn generate-view action-btn">Gerar Visualiza√ß√£o por Categoria</button>
     <button id="viewResolvedViewButton" class="btn generate-view action-btn">Visualizar Respondidos (Per√≠odo)</button>
     <button id="viewPerseveranceReportButton" class="btn action-btn">Relat√≥rio Pessoal</button>
     <button id="viewInteractionReportButton" class="btn action-btn">Relat√≥rio por Alvo</button>
     <button id="forceDriveSyncButton" class="btn action-btn">For√ßar Sincroniza√ß√£o com Drive</button>
    </div>

    <hr class="menu-separator">

    <div class="weekly-perseverance-chart" id="weeklyPerseveranceChart" style="display: none;">
        <div class="weekly-header">
            <h3>Sua Semana de Ora√ß√£o</h3>
        </div>
        <div class="days-container">
            <div class="day">
                <span class="day-name">Dom</span>
                <span class="day-tick" id="day-0"></span>
            </div>
            <div class="day">
                <span class="day-name">Seg</span>
                <span class="day-tick" id="day-1"></span>
            </div>
            <div class="day">
                <span class="day-name">Ter</span>
                <span class="day-tick" id="day-2"></span>
            </div>
            <div class="day">
                <span class="day-name">Qua</span>
                <span class="day-tick" id="day-3"></span>
            </div>
            <div class="day">
                <span class="day-name">Qui</span>
                <span class="day-tick" id="day-4"></span>
            </div>
            <div class="day">
                <span class="day-name">Sex</span>
                <span class="day-tick" id="day-5"></span>
            </div>
            <div class="day">
                <span class="day-name">S√°b</span>
                <span class="day-tick" id="day-6"></span>
            </div>
        </div>
    </div>

    <div class="perseverance-section" id="perseveranceSection" style="display: none;">
    <div class="perseverance-header">
        <h2>Perseveran√ßa na Intercess√£o</h2>
    </div>
    <div class="milestone-icons-area" id="milestoneIconsArea">
        <!-- Os √≠cones de marcos ser√£o inseridos aqui dinamicamente pelo ui.js -->
    </div>

    <div class="perseverance-bar-container" title="Confirme sua perseveran√ßa di√°ria aqui">
        <div class="progress-bar" id="progressBarElement">
            <span class="progress-percentage-left" id="perseverancePercentage">
                <span id="currentDaysText">0</span> / <span id="recordDaysText">0</span> dias
            </span>
            <div class="progress" id="perseveranceProgressBar" style="width: 0%;">
                <div class="progress-shine-overlay"></div>
            </div>
        </div>
    </div>
    
    <div class="milestone-legend">
        <span>üå± 7d</span> | <span>üî• 15d</span> | <span>‚≠ê 30d</span> | <span>üå≥ 100d</span> | <span>üíé 300d</span> | <span>‚òÄÔ∏è 1000d</span>
    </div>
</div>

    <div class="form-section" id="appContent" style="display: none;">
        <h2>Cadastrar Novo Alvo de Ora√ß√£o</h2>
        <form id="prayerForm">
            <label for="title">T√≠tulo:</label>
            <input type="text" id="title" placeholder="Ex.: Sa√∫de da Fam√≠lia" required>

            <label for="details">Observa√ß√µes:</label>
            <textarea id="details" placeholder="Escreva aqui os detalhes do pedido..."></textarea>

            <label for="date">Data Cria√ß√£o:</label>
            <input type="date" id="date" required>

            <div class="checkbox-container">
                <input type="checkbox" id="hasDeadline" name="hasDeadline">
                <label for="hasDeadline">Este alvo tem prazo de validade?</label>
            </div>

            <div id="deadlineContainer" style="display: none;">
                <label for="deadlineDate">Prazo de Validade:</label>
                <input type="date" id="deadlineDate">
            </div>

            <div class="checkbox-container">
                <input type="checkbox" id="isPriority" name="isPriority">
                <label for="isPriority">Marcar como alvo priorit√°rio?</label>
            </div>

            <label for="categorySelect">Categoria:</label>
            <select id="categorySelect">
                <option value="" selected>-- Selecione uma Categoria --</option>
                <option value="Fam√≠lia">Fam√≠lia</option>
                <option value="Pessoal">Pessoal</option>
                <option value="Igreja">Igreja</option>
                <option value="Trabalho">Trabalho</option>
                <option value="Sonho">Sonho</option>
                <option value="Prof√©tico">Prof√©tico</option>
                <option value="Promessas">Promessas</option>
                <option value="Esposa">Esposa</option>
                <option value="Filhas">Filhas</option>
                <option value="Minist√©rio de Intercess√£o">Minist√©rio de Intercess√£o</option>
                <option value="Outros">Outros</option>
            </select>

            <button type="submit" class="btn submit-btn">Adicionar Alvo</button>
        </form>
    </div>

    <hr class="section-separator" id="sectionSeparator" style="display: none;">

    <div class="priority-section" id="prioritySection" style="display: none;">
        <h2 class="priority-title-header">
            <span>Alvos Priorit√°rios</span>
            <span class="priority-title-badge">Conclu√≠do</span>
        </h2>
        <div id="priorityTargetsList">
            <p>Carregando alvos priorit√°rios...</p>
        </div>
        <div id="priorityCompletionMessage" class="priority-completion-message" style="display: none;">
            <h3>Parab√©ns!</h3>
            <p>Voc√™ intercedeu por todos os seus alvos priorit√°rios de hoje.</p>
        </div>
    </div>

    <div class="daily-section" id="dailySection" style="display: none;">
        <h2>
            Alvos de Ora√ß√£o do Dia
            <div class="daily-buttons-container">
                <button id="refreshDaily" class="btn daily-action-btn">Atualizar Alvos do Dia</button>
                <button id="copyDaily" class="btn daily-action-btn">Copiar Alvos Pendentes</button>
                <button id="viewDaily" class="btn daily-view">Visualizar Detalhes do Dia</button>
                <button id="addManualTargetButton" class="btn daily-action-btn">Adicionar Alvo Manualmente</button>
            </div>
        </h2>
        <div id="dailyVerses" class="daily-verses"></div>
        <div id="dailyTargets">
            <p>Carregando alvos do dia...</p>
        </div>
        <div id="completionPopup" class="popup" style="display: none;">
            <div class="popup-content">
                <h3>Parab√©ns!</h3>
                <p>Voc√™ orou por todos os alvos selecionados para hoje!</p>
                <p id="popupVerse" class="popup-verse">‚ÄúVers√≠culo inspirador aqui.‚Äù</p>
                <button id="closePopup" class="btn">Fechar</button>
            </div>
        </div>
    </div>

   <div class="targets-section" id="mainPanel" style="display: none;">
    <h2>Alvos de Ora√ß√£o Ativos</h2>
    <hr class="title-separator">
    <input type="text" id="searchMain" placeholder="Pesquisar por t√≠tulo, detalhe, categoria ou observa√ß√£o..." class="search-input">
    <hr class="search-separator">

    <!-- NOVO BLOCO DE FILTROS DE CATEGORIA -->
    <div id="mainCategoryFilters" class="manual-category-filters" style="justify-content: center; margin-bottom: 15px;">
        <!-- Os filtros de categoria ser√£o inseridos aqui pelo JavaScript -->
    </div>

    <div class="filter-controls">
        <div class="filter-container">
            <input type="checkbox" id="showDeadlineOnly" name="showDeadlineOnly">
            <label for="showDeadlineOnly">Mostrar apenas com prazo</label>
        </div>
        <div class="filter-container">
            <input type="checkbox" id="showExpiredOnlyMain" name="showExpiredOnlyMain">
            <label for="showExpiredOnlyMain">Mostrar apenas com prazo vencido</label>
        </div>
    </div>
    <hr class="filter-separator">
    <div id="targetList">
        <p>Carregando alvos...</p>
    </div>
    <div id="pagination-mainPanel" class="pagination"></div>
</div>

<div class="targets-section" id="archivedPanel" style="display: none;">
    <h2>Alvos Arquivados</h2>
    <hr class="title-separator">
    <input type="text" id="searchArchived" placeholder="Pesquisar nos arquivados (t√≠tulo, detalhe, categoria...)" class="search-input">
    <hr class="search-separator">
    <div id="archivedList">
         <p>Carregando arquivados...</p>
    </div>
    <div id="pagination-archivedPanel" class="pagination"></div>
</div>

<div class="targets-section" id="resolvedPanel" style="display: none;">
    <h2>Alvos Respondidos</h2>
    <hr class="title-separator">
    <input type="text" id="searchResolved" placeholder="Pesquisar nos respondidos (t√≠tulo, detalhe, categoria...)" class="search-input">
    <hr class="search-separator">
    <div id="resolvedList">
         <p>Carregando respondidos...</p>
    </div>
    <div id="pagination-resolvedPanel" class="pagination"></div>
</div>

    <!-- Modal para Sele√ß√£o de Datas (Visualizar Respondidos) -->
    <div id="dateRangeModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-button" id="closeDateRangeModal">√ó</span>
            <h2>Visualizar Respondidos por Per√≠odo</h2>
            <label for="startDate">Data de In√≠cio:</label>
            <input type="date" id="startDate" required>
            <label for="endDate">Data de Fim:</label>
            <input type="date" id="endDate" required>
            <div class="modal-buttons">
                 <button id="generateResolvedView" class="btn modal-action-btn">Gerar Visualiza√ß√£o</button>
                 <button id="cancelDateRange" class="btn modal-cancel-btn">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal para Adicionar Alvo Manualmente ao Dia -->
    <div id="manualTargetModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-button" id="closeManualTargetModal">√ó</span>
            <h2>Adicionar Alvo Manualmente ao Dia</h2>
            <label for="manualTargetSearchInput">Pesquisar Alvo Ativo:</label>
            <input type="text" id="manualTargetSearchInput" placeholder="Digite t√≠tulo, detalhe ou categoria...">
            
            <div id="manualTargetCategoryFilters" class="manual-category-filters">
                <!-- Filtros de categoria ser√£o inseridos aqui pelo JavaScript -->
            </div>

            <div id="manualTargetSearchResults" class="manual-search-results">
                <p>Digite algo para buscar...</p>
            </div>
        </div>
    </div>

    <!-- Modal para Sele√ß√£o de Categorias (Visualiza√ß√£o por Categoria) -->
    <div id="categorySelectionModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-button" id="closeCategoryModal">√ó</span>
            <h2>Sele√ß√£o de Categorias para Visualiza√ß√£o</h2>
            <p>Marque as categorias que deseja incluir na visualiza√ß√£o:</p>
            <div id="categoryCheckboxesContainer" class="category-checkboxes-container">
                <!-- Checkboxes ser√£o populados pelo script.js -->
            </div>
            <div class="modal-buttons">
                <button id="confirmCategoryView" class="btn modal-action-btn">Gerar Visualiza√ß√£o</button>
                <button id="cancelCategoryView" class="btn modal-cancel-btn">Cancelar</button>
           </div>
        </div>
    </div>
    
    <!-- Modal para Changelog -->
    <div id="changelogModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-button" id="closeChangelogModal">√ó</span>
            <h2 id="changelogModalTitle">Novidades da Vers√£o</h2>
            <div id="changelogModalBody" class="changelog-body">
                <!-- Conte√∫do ser√° inserido via JavaScript -->
            </div>
        </div>
    </div>

    <!-- NOVO: Navegador Flutuante -->
    <div id="floatingNav" class="floating-nav hidden">
        <a href="#" data-action="scroll-up" class="nav-btn up-btn" title="Ir para o Alvo Anterior">
            <!-- √çcone de seta fina para cima (SVG) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="18 15 12 9 6 15"></polyline></svg>
        </a>
        <a href="#prioritySection" class="nav-btn priority-btn" title="Ir para Alvos Priorit√°rios">
            <span>‚≠ê</span> <!-- √çcone de estrela (Star) -->
        </a>
        <a href="#dailySection" class="nav-btn daily-btn" title="Ir para Alvos do Dia">
            <span>‚òÄÔ∏è</span> <!-- √çcone de sol (Sun) -->
        </a>
        <a href="#" data-action="scroll-down" class="nav-btn down-btn" title="Ir para o Pr√≥ximo Alvo">
            <!-- √çcone de seta fina para baixo (SVG) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
        </a>
        <a href="#top" class="nav-btn top-btn" title="Ir para o Topo">
            <!-- √çcone de casa (Home) CORRIGIDO -->
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
        </a>
    </div>

    <!-- NOVO: Toast de Notifica√ß√£o para Prazos Vencidos -->
    <div id="expiredToast" class="toast-notification hidden">
        <span id="expiredToastMessage">Voc√™ tem alvos com prazo vencido!</span>
        <button id="closeExpiredToast" class="toast-close-btn">√ó</button>
    </div>
    
    <!-- NOVO: Adicionado script da API do Google -->
    <script async defer src="https://apis.google.com/js/api.js"></script>
    <script type="module" src="js/script.js"></script>
</body>
</html>
